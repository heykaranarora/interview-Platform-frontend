{"ast":null,"code":"import _objectSpread from\"C:/Users/Lenovo/OneDrive/Desktop/Interview Prep mern/frontend/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState}from\"react\";import{Loader2,Pen}from\"lucide-react\";import{useDispatch,useSelector}from\"react-redux\";import{setUser}from\"../redux/authSlice\";import{toast}from\"react-toastify\";import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const validatePhoneNumber=phoneNumber=>{if(typeof phoneNumber!==\"string\")return false;const cleaned=phoneNumber.replace(/\\D/g,\"\");return cleaned.length===10;};const UpdateProfileDialog=_ref=>{var _user$profile,_user$profile2,_user$profile2$skills;let{open,setOpen}=_ref;const dispatch=useDispatch();const[loading,setLoadingState]=useState(false);const{user}=useSelector(store=>store.auth);const[input,setInput]=useState({name:(user===null||user===void 0?void 0:user.name)||\"\",email:(user===null||user===void 0?void 0:user.email)||\"\",phoneNumber:(user===null||user===void 0?void 0:user.phoneNumber)||\"\",bio:(user===null||user===void 0?void 0:(_user$profile=user.profile)===null||_user$profile===void 0?void 0:_user$profile.bio)||\"\",skills:(user===null||user===void 0?void 0:(_user$profile2=user.profile)===null||_user$profile2===void 0?void 0:(_user$profile2$skills=_user$profile2.skills)===null||_user$profile2$skills===void 0?void 0:_user$profile2$skills.join(\", \"))||\"\"});const changeEventHandler=e=>{const{name,value}=e.target;setInput(prevInput=>_objectSpread(_objectSpread({},prevInput),{},{[name]:value}));};const submitHandler=async e=>{e.preventDefault();console.log(\"Updating profile...\");if(!validatePhoneNumber(input.phoneNumber)){toast.error(\"Phone number must be exactly 10 digits.\");setLoadingState(false);return;}setLoadingState(true);try{const response=await fetch(\"https://interview-platform-backend-xp3r.onrender.com/api/v1/user/profile/update\",{method:\"POST\",credentials:\"include\",headers:{\"Content-Type\":\"application/json\"},body:JSON.stringify(input)});const data=await response.json();if(data.success){dispatch(setUser(data.user));toast.success(data.message);setOpen(false);// ✅ Close modal only if update succeeds\n}else{toast.error(data.message||\"Profile update failed\");}}catch(error){console.error(\"Error:\",error);toast.error(\"Profile update failed\");}finally{setLoadingState(false);}};return open?/*#__PURE__*/_jsx(\"div\",{className:\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white w-full max-w-md rounded-lg shadow-lg p-6\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"text-xl font-semibold mb-4\",children:\"Update Profile\"}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:submitHandler,className:\"space-y-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Name\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:input.name,onChange:changeEventHandler,className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",name:\"email\",value:input.email,onChange:changeEventHandler,className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Phone Number\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"phoneNumber\",value:input.phoneNumber,onChange:changeEventHandler,pattern:\"\\\\d{10}\",title:\"Phone number must be exactly 10 digits\",className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Bio\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"bio\",value:input.bio,onChange:changeEventHandler,className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"label\",{className:\"block text-sm font-medium\",children:\"Skills\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"skills\",value:input.skills,onChange:changeEventHandler,className:\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-end space-x-2 mt-4\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setOpen(false),className:\"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100\",children:\"Cancel\"}),/*#__PURE__*/_jsxs(\"button\",{type:\"submit\",className:\"px-4 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-700 flex items-center\",disabled:loading,children:[loading&&/*#__PURE__*/_jsx(Loader2,{className:\"animate-spin mr-2 h-4 w-4\"}),loading?\"Updating...\":\"Update\"]})]})]})]})}):null;};export default UpdateProfileDialog;","map":{"version":3,"names":["React","useState","Loader2","Pen","useDispatch","useSelector","setUser","toast","jsx","_jsx","jsxs","_jsxs","validatePhoneNumber","phoneNumber","cleaned","replace","length","UpdateProfileDialog","_ref","_user$profile","_user$profile2","_user$profile2$skills","open","setOpen","dispatch","loading","setLoadingState","user","store","auth","input","setInput","name","email","bio","profile","skills","join","changeEventHandler","e","value","target","prevInput","_objectSpread","submitHandler","preventDefault","console","log","error","response","fetch","method","credentials","headers","body","JSON","stringify","data","json","success","message","className","children","onSubmit","type","onChange","pattern","title","onClick","disabled"],"sources":["C:/Users/Lenovo/OneDrive/Desktop/Interview Prep mern/frontend/src/components/UpdateProfileDialog.jsx"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport { Loader2, Pen } from \"lucide-react\";\r\nimport { useDispatch, useSelector } from \"react-redux\";\r\nimport { setUser } from \"../redux/authSlice\";\r\nimport { toast } from \"react-toastify\";\r\n\r\nconst validatePhoneNumber = (phoneNumber) => {\r\n  if (typeof phoneNumber !== \"string\") return false;\r\n  const cleaned = phoneNumber.replace(/\\D/g, \"\");\r\n  return cleaned.length === 10;\r\n};\r\n\r\nconst UpdateProfileDialog = ({ open, setOpen }) => {\r\n  const dispatch = useDispatch();\r\n  const [loading, setLoadingState] = useState(false);\r\n  const { user } = useSelector((store) => store.auth);\r\n\r\n  const [input, setInput] = useState({\r\n    name: user?.name || \"\",\r\n    email: user?.email || \"\",\r\n    phoneNumber: user?.phoneNumber || \"\",\r\n    bio: user?.profile?.bio || \"\",\r\n    skills: user?.profile?.skills?.join(\", \") || \"\",\r\n  });\r\n\r\n  const changeEventHandler = (e) => {\r\n    const { name, value } = e.target;\r\n    setInput((prevInput) => ({\r\n      ...prevInput,\r\n      [name]: value,\r\n    }));\r\n  };\r\n\r\n  const submitHandler = async (e) => {\r\n    e.preventDefault();\r\n    console.log(\"Updating profile...\");\r\n    \r\n    if (!validatePhoneNumber(input.phoneNumber)) {\r\n        toast.error(\"Phone number must be exactly 10 digits.\");\r\n        setLoadingState(false);\r\n        return;\r\n    }\r\n    setLoadingState(true);\r\n\r\n    try {\r\n      const response = await fetch(\"https://interview-platform-backend-xp3r.onrender.com/api/v1/user/profile/update\", {\r\n        method: \"POST\",\r\n        credentials: \"include\",\r\n        headers: { \"Content-Type\": \"application/json\" },\r\n        body: JSON.stringify(input),\r\n      });\r\n\r\n      const data = await response.json();\r\n\r\n      if (data.success) {\r\n        dispatch(setUser(data.user));\r\n        toast.success(data.message);\r\n        setOpen(false);  // ✅ Close modal only if update succeeds\r\n      } else {\r\n        toast.error(data.message || \"Profile update failed\");\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      toast.error(\"Profile update failed\");\r\n    } finally {\r\n      setLoadingState(false);\r\n    }\r\n  };\r\n\r\n  return open ? (\r\n    <div className=\"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50\">\r\n      <div className=\"bg-white w-full max-w-md rounded-lg shadow-lg p-6\">\r\n        <h2 className=\"text-xl font-semibold mb-4\">Update Profile</h2>\r\n        <form onSubmit={submitHandler} className=\"space-y-4\">\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Name</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"name\"\r\n              value={input.name}\r\n              onChange={changeEventHandler}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Email</label>\r\n            <input\r\n              type=\"email\"\r\n              name=\"email\"\r\n              value={input.email}\r\n              onChange={changeEventHandler}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Phone Number</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"phoneNumber\"\r\n              value={input.phoneNumber}\r\n              onChange={changeEventHandler}\r\n              pattern=\"\\d{10}\"\r\n              title=\"Phone number must be exactly 10 digits\"\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Bio</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"bio\"\r\n              value={input.bio}\r\n              onChange={changeEventHandler}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div>\r\n            <label className=\"block text-sm font-medium\">Skills</label>\r\n            <input\r\n              type=\"text\"\r\n              name=\"skills\"\r\n              value={input.skills}\r\n              onChange={changeEventHandler}\r\n              className=\"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500\"\r\n            />\r\n          </div>\r\n\r\n          <div className=\"flex justify-end space-x-2 mt-4\">\r\n            <button\r\n              type=\"button\"\r\n              onClick={() => setOpen(false)}\r\n              className=\"px-4 py-2 text-gray-700 border border-gray-300 rounded-md hover:bg-gray-100\"\r\n            >\r\n              Cancel\r\n            </button>\r\n            <button\r\n              type=\"submit\"\r\n              className=\"px-4 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-700 flex items-center\"\r\n              disabled={loading}\r\n            >\r\n              {loading && <Loader2 className=\"animate-spin mr-2 h-4 w-4\" />}\r\n              {loading ? \"Updating...\" : \"Update\"}\r\n            </button>\r\n          </div>\r\n        </form>\r\n      </div>\r\n    </div>\r\n  ) : null;\r\n};\r\n\r\nexport default UpdateProfileDialog;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}